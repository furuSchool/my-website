---
title: 6. ランダム信号の解析
---

:::warning[目標]
これまでは確定信号を扱ってきたが，ここでは確率的変動を伴う信号を扱う。
つまり 1 つ 1 つの信号ではなく，信号波形の集合に共通する性質を考える。
ただし，信号の中でも **統計的規則性** があるものを扱う。
- 確率変数 $X$ : 確率的に変動する変数
- 確率過程 $\{X(t)\}$ : 時間によって変化する確率変数の集合のこと。信号を扱う場合，**ランダム信号** ともいう
:::
- 統計的規則性がある = それぞれの事象は確率的だが，数多く観測すると統計的に共通の性質があるもの

ランダム信号の記述方法としては，以下のようなものがある。
1. 標本信号を多数並べる
2. 確率変数を用いて式で表す
3. 確率分布や統計量で表す
4. 信号の生成過程を示す・モデル化する
---
## 基本

:::tip[ランダム信号の原理]
ランダム信号は，任意の時刻 $t_1, …, t_n$ における確率密度関数 (PDF) $p(x_1,t_1; …, x_n,t_n)$ が与えられれば完全に記述される。
この時，時刻 $t_i$ で信号値 $x_i$ が得られたとする。
:::
異なる標本信号から信号値を得ても良い。
つまり，ある確率変数から任意個の信号を取り出して，任意の時刻にその中のある信号から値を得る確率が与えられれば，その信号は完全に記述される。

式で書くと，$p(x_1,t_1; …, x_n,t_n) = \lim_{\Delta x_1, …, \Delta x_n \to 0} P(x_1 \leq x(t_1) < x_1 + \Delta x_1, …, x_n \leq x(t_n) < x_n + \Delta x_n)$ となる。
つまり，時刻 $t_1, …, t_n$ における信号値 $x(t_1), …, x(t_n)$ の同時確率密度関数である。

### 統計量
数学的な詳細は，[確率統計](/docs/math/statistics)を参照。**集合** は特定の時刻の異なる信号を集めたもの，**時間** はある信号の異なる時刻の信号値を集めたもの。

- 集合平均 $E[x(t)] = \frac{1}{N} \sum_{i=1}^{N} x_i(t),~\int_{-\infty}^{\infty} x p(x,t) dx$ : 時刻 $t$ における信号の期待値
- 集合相関 $E[x(t_1)x(t_2)] = \frac{1}{N} \sum_{i=1}^{N} x_i(t_1)x_i(t_2),~\int_{-\infty}^{\infty} x_1 x_2 p(x_1, t_1; x_2, t_2) dx_1 dx_2$ : 時刻 $t_1, t_2$ における相関の期待値
- 時間平均 $\braket{x_1(t)} = \lim_{T \to \infty}\frac{1}{T} \sum_{t=0}^{T} x_1(t),~\lim_{T \to \infty}\frac{1}{T} \int_{0}^{T} x_1(t) dt$ : ある標本信号の時刻 $0$ から $T$ までの $x$ の平均値


### 自己相関関数
:::tip[自己相関関数]
自己相関関数は，定常なランダム信号の統計的性質を表す重要な関数。$\phi_x (\tau) = E[x(t)x(t+\tau)]$
:::
- ただし，$E[x(t)] = 0$ としている。実際は，$\phi_x (\tau) = E[(x(t) - E[x(t)])(x(t+\tau) - E[x(t+\tau)])]$
    - つまり，直流成分を除去している
- 自己相関関数の性質 :
    - $\phi_x (\tau) = \phi_x (-\tau)$ (対称性)
    - $\phi_x (0) = E[x(t)^2]$ (平均電力)
    - $\phi_x (0) \geq \phi_x (\tau)$ (原点での値が最大)
- $C(\tau)$ と書くこともある

### 相互相関関数
:::tip[相互相関関数]
相互相関関数は，2 つの定常なランダム信号の統計的性質を表す関数。$\phi_{xy} (\tau) = E[x(t)y(t+\tau)]$
:::
- 同様に，$E[x(t)] = 0, E[y(t)] = 0$ としている
- 相互相関関数の性質 :
    - $\phi_{xy} (\tau) = \phi_{yx} (-\tau)$ (対称性，ただし偶関数とは限らない)
    - $|\phi_{xy} (\tau)| \leq \sqrt{\phi_x (0) \phi_y (0)}$

### 信号の種類
:::note[信号の種類]
- 非定常信号 : 統計的な性質が時点によって異なる信号
    - 例 : 地震波などほとんどの自然現象
- 定常信号 : 統計的な性質がどの時点でも同じである信号。2 種類に分けられる
    - 強定常信号 : 任意の確率密度関数が時間シフトに対して不変な信号
    - 弱定常信号 : 1 次統計量と 2 次統計量が時間差のみの関数である信号。つまり，以下の条件を満たす信号
        - $E[x(t)] = \mu$ (平均値が $t$ に依存しない)
        - $E[x(t)x(t+\tau)] = \phi_x(\tau)$ (自己相関関数が時間差 $\tau$ のみに依存する)
:::

---
## エルゴード性
:::tip[エルゴード定理]
- **エルゴード性** : 強定常であり，強定常な真部分集合を持たない信号。
直感的には，**確率過程から取り出した 1 本の標本信号が，その過程全体を代表するような性質を持つこと**
- **エルゴード仮説** : 複雑な定常物理現象はエルゴード性を満たす
- **エルゴード定理** : エルゴード性を満たす集合は，時間平均と集合平均が等しい。すなわち，$E[x(t)] = \braket{x(t)}$
:::
集合の性質が知りたいが，この性質を知ることは難しい。一方で，ある信号を取り出してその信号の性質を調べることは比較的容易であるため，
エルゴード性を仮定すると，集合の性質を一つの信号の性質から推定できる。

### エルゴード性を満たす信号で成り立つ性質
- 集合平均 : $E[x(t)] = \braket{x(t)}$
- 自己相関関数 : $\phi_x (\tau) = E[x(t)x(t+\tau)] = \braket{x(t)x(t+\tau)} = \lim_{T \to \infty} \frac{1}{T} \int_{0}^{T} x(t)x(t+\tau) dt$

**例 : $A\cos(\omega t + \theta)$ の自己相関関数** : エルゴード性を仮定すると，  
$\phi_x (\tau) = E[x(t)x(t+\tau)] = \braket{x(t)x(t+\tau)} = A^2\braket{\cos(\omega t + \theta)\cos(\omega (t+\tau) + \theta)} = \frac{A^2}{2} \cos(\omega \tau)$  
他にも，白色雑音 : $\phi_x (\tau) = \sigma^2 \delta(\tau)$ ( $\sigma^2$ は分散)

---
## 周波数領域における統計量
### パワースペクトル密度 (電力スペクトル密度) 
:::tip[パワースペクトル密度]
パワースペクトル密度は信号のもつ電力の周波数分布を表し，ランダム信号の周波数特性を調べるのに用いられる。  
$\Phi_X(f) = \lim_{T \to \infty} \frac{1}{T} \int_{0}^{T} E[|X(f)|^2] = \lim_{T \to \infty} E[\frac{1}{T} |\int_{0}^{T} x(t)e^{-j2\pi ft} dt|^2]$

**この時，$\Phi_X(f) = \mathcal{F}[\phi_x(\tau)]$ (ウィーナー・ヒンチンの定理) が成り立つ。**
:::
- $\Phi_X(f) \geq 0$ (非負性)
- $x(t)$ が実関数の時、 $\Phi_X(f) = \Phi_X(-f)$ (偶関数)
- 平均電力 $P = E[\frac{1}{T} \int_{0}^{T} |x(t)|^2 dt] = \int_{-\infty}^{\infty} \Phi_X(f) df$
- $S(\omega)$ などと表記することもある


### 相互パワースペクトル密度
:::tip[相互パワースペクトル密度]
相互パワースペクトル密度 : $\Phi_{XY}(f) = \lim_{T \to \infty} \frac{1}{T} \int_{0}^{T} E[X^*(f)Y(f)]$

**この時，$\Phi_{XY}(f) = \mathcal{F}[\phi_{xy}(\tau)]$ が成り立つ。**
:::
- $\Phi_{XY}(f) = \Phi_{YX}^*(f)$ (複素共役)
- $|\Phi_{XY}(f)| \leq \sqrt{\Phi_X(f) \Phi_Y(f)}$ (コーシー・シュワルツの不等式)
- コヒーレンシー : $C_{XY}(f) = \frac{\Phi_{XY}(f)}{\sqrt{\Phi_X(f) \Phi_Y(f)}}$ ( $-1 \leq |C_{XY}(f)| \leq 1$ )

---
## ランダム信号の線形システム
ここで，ランダム信号を線形システム $h(t),~ H(f)$ に通した時を考える。
- 入力信号 : $\phi_x(\tau),~\Phi_X(f)$ でランダム信号の性質を表す
- 出力信号 : $\phi_y(\tau),~\Phi_Y(f)$
- $\phi_{xy}(\tau),~\Phi_{XY}(f)$

この時，以下の関係が成り立つ。
:::note[ランダム信号の線形システム]
- $\phi_{xy}(\tau) = h(\tau) * \phi_x(\tau) = \int_{-\infty}^{\infty} h(\tau - \tau') \phi_x(\tau') d\tau'$ (畳み込み)
- $\Phi_{XY}(f) = H(f) \Phi_X(f)$
- $\phi_y(\tau) = h^*(-\tau) * \phi_{xy}(\tau)$
- $\Phi_Y(f) = H^*(f) \Phi_{XY}(f) = |H(f)|^2 \Phi_X(f)$
:::