---
title: 5. 不規則信号の解析
---

:::warning[目標]
これまでは確定信号を扱ってきたが，ここからは確率的変動を伴う信号を扱う。
つまり 1 つ 1 つの信号ではなく，信号波形の集合に共通する性質を考える。
ただし，信号の中でも **統計的規則性** があるものを扱う。
- 不規則変数 : 事象が数字で表される確率統計現象
- 不規則信号 : 事象が時間信号で表される確率統計現象
:::
- 統計的規則性がある = それぞれの事象は確率的だが，数多く観測すると統計的に共通の性質があるもの

不規則信号の記述方法としては，以下のようなものがある。
1. 標本信号を多数並べる
2. 確率変数を用いて式で表す
3. 確率分布や統計量で表す
4. 信号の生成過程を示す・モデル化する

---
## 基本
:::tip[不規則信号の公理]
不規則信号は，任意の時刻 $t_1, …, t_n$ における確率密度関数 (PDF) $p(x_1,t_1; …, x_n,t_n)$ が与えられれば完全に記述される。
この時，時刻 $t_i$ で信号値 $x_i$ が得られたとする。この時，信号値が同じ信号から得られる必要はない。
:::
つまり，ある確率変数から任意個の信号を取り出して，任意の時刻にその中のある信号から値を得る確率が与えられれば，その信号は完全に記述される。

### 信号の種類
:::note[信号の種類]
- 定常信号 : 統計的な性質がどの時点でも同じである信号
- 非定常信号 : 統計的な性質が時点によって異なる信号
    - 例 : 地震波などほとんどの自然現象
- 強定常信号 : 任意の確率密度関数が時間差のみの関数である信号
- 弱定常信号 : 1 次統計量と 2 次統計量が時間差のみの関数である信号
:::

### 統計量
数学的な詳細は，[確率統計](/docs/math/statistics)を参照。**集合** は特定の時刻の異なる信号を集めたもの，**時間** はある信号の異なる時刻の信号値を集めたもの。

- 集合平均 $E[x(t)] = \frac{1}{N} \sum_{i=1}^{N} x_i(t) = \int_{-\infty}^{\infty} x p(x,t) dx$ : 時刻 $t$ における信号の期待値
- 集合相関 $E[x(t_1)x(t_2)] = \frac{1}{N} \sum_{i=1}^{N} x_i(t_1)x_i(t_2) = \int_{-\infty}^{\infty} x_1 x_2 p(x_1, t_1; x_2, t_2) dx_1 dx_2$ : 時刻 $t_1, t_2$ における相関の期待値
- 時間平均 $\braket{x(t)} = \frac{1}{T} \sum_{t=0}^{T} x(t) = \frac{1}{T} \int_{0}^{T} x(t) dt$ : ある信号の時刻 $0$ から $T$ までの平均値
- 相互相関 $\phi_{xy} (\tau) = \braket{x(t)y(t+\tau)}$ : 時刻 $t$ における信号 $x$ と時刻 $t+\tau$ における信号 $y$ の積の平均
- 相互分散 $k_{x,y}(\tau) = \braket{(x(t) - \braket{x(t)})(y(t+\tau) - \braket{y(t+\tau)})}$ : 時刻 $t$ における信号 $x$ と時刻 $t+\tau$ における信号 $y$ の偏差の積の平均

### 相関関数
- 自己相関関数 $\phi_x (\tau) = E[x(t)x(t+\tau)] = \lim_{T \to \infty} \frac{1}{T} \int_{0}^{T} x(t)x(t+\tau) dt$
: 時刻 $t$ と $t+\tau$ における同じ信号の相関
    - ただし，$\braket{x(t)} = 0$ であるとしている
- 相互相関関数 $\phi_{xy} (\tau) = E[x(t)y(t+\tau)] = \lim_{T \to \infty} \frac{1}{T} \int_{0}^{T} x(t)y(t+\tau) dt$
 : 時刻 $t$ における信号 $x$ と時刻 $t+\tau$ における信号 $y$ の相関
    - 同様に，$\braket{x(t)} = 0,~ \braket{y(t)} = 0$ としている

##### 相関関数の性質
- **自己相関関数の性質** :
    - $\phi_x (\tau) = \phi_x (-\tau)$ (対称性)
    - $\phi_x (0) = E[x(t)^2] = \braket{x(t)^2}$ (平均電力)
    - $\phi_x (0) \geq \phi_x (\tau)$ (コーシー・シュワルツの不等式)
- **相互相関関数の性質** :
    - $\phi_{xy} (\tau) = \phi_{yx} (-\tau)$ (対称性，ただし偶関数とは限らない)
    - $|\phi_{xy} (\tau)| \leq \sqrt{\phi_x (0) \phi_y (0)}$ (コーシー・シュワルツの不等式)


- **例 : $A\cos(\omega t + \theta)$ の自己相関関数** : エルゴード性を仮定すると，  
$\phi_x (\tau) = E[x(t)x(t+\tau)] = \braket{x(t)x(t+\tau)} = A^2\braket{\cos(\omega t + \theta)\cos(\omega (t+\tau) + \theta)} = \frac{A^2}{2} \cos(\omega \tau)$
- 白色雑音 : $\phi_x (\tau) = \sigma^2 \delta(\tau)$ ( $\sigma^2$ は分散)

### 周波数領域における統計量
- パワースペクトル密度 (電力スペクトル密度) $\Phi_X(f) = \lim_{T \to \infty} \frac{1}{T} \int_{0}^{T} E[|X(f)|^2]$
- 相互パワースペクトル密度 $\Phi_{XY}(f) = \lim_{T \to \infty} \frac{1}{T} \int_{0}^{T} E[X^*(f)Y(f)]$

#### パワースペクトル密度の性質
- **パワースペクトル密度の性質** : 
    - $\Phi_X(f) = \mathcal{F}[\phi_x(\tau)] = \int_{-\infty}^{\infty} \phi_x(\tau) e^{-j2\pi f \tau} d\tau$ (フーリエ変換)
    - $\Phi_X(f) \geq 0$ (非負性)
    - $x(t)$ が実関数の時、 $\Phi_X(f) = \Phi_X(-f)$ (偶関数)
    - 平均電力 $P_x = E[\frac{1}{T} \int_{0}^{T} x^2(t) dt] = \int_{-\infty}^{\infty} \Phi_X(f) df$ (パワー定理)
- **相互パワースペクトル密度の性質** : 
    - $\Phi_{XY}(f) = \mathcal{F}[\phi_{xy}(\tau)] = \int_{-\infty}^{\infty} \phi_{xy}(\tau) e^{-j2\pi f \tau} d\tau$ (フーリエ変換)
    - $\Phi_{XY}(f) = \Phi_{YX}^*(f)$ (複素共役)
    - $|\Phi_{XY}(f)| \leq \sqrt{\Phi_X(f) \Phi_Y(f)}$ (コーシー・シュワルツの不等式)
        - コヒーレンシー : $C_{XY}(f) = \frac{\Phi_{XY}(f)}{\sqrt{\Phi_X(f) \Phi_Y(f)}}$ ( $-1 \leq C_{XY}(f) \leq 1$ )

### エルゴード性
:::tip[エルゴード定理]
- **エルゴード性** : 強定常であり，強定常な真部分集合を持たない信号
- **エルゴード仮説** : 複雑な定常物理現象はエルゴード性を満たす
- **エルゴード定理** : エルゴード性を満たす集合は，時間平均と集合平均が等しい。すなわち，$E[x(t)] = \braket{x(t)}$
:::