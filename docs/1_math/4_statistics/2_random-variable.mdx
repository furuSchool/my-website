---
title: 2. 確率変数
---
厳密には，確率論は測度論に基づく理論であるが，ここでは誤魔化して書いている。

## 基本
:::tip[基本]
確率変数 $X$ : 確率的に変動する変数。 $X$ が実際に取る値を実現値 $x$ と呼ぶ。また，ある事象 $A$ が起きる確率を $P(A)$ と書く。
1. 実現値 $x$ が離散値の場合
    - $X$ の確率関数 $p(x) = P(X = x)$，累積分布関数 $F(x) = P(X \leq x) = \sum_{x' \leq x} p(x')$
2. 実現値 $x$ が連続値の場合
    - $X$ の確率密度関数 $f(x) = \lim_{\epsilon \to 0} \frac{P(x < X < x + \epsilon)}{\epsilon}$，累積分布関数 (pdf) $F(x) = P(X \leq x) = \int_{-\infty}^x f(x') dx'$
    - $f(x) = F'(x)$
    - $P(a < X < b) = \int_a^b f(x) dx$
:::
- 離散確率変数の場合は，$\sum_{x} p(x) = 1$
- 連続確率変数の場合は，$P(X = x) = 0$，$\int_{-\infty}^{\infty} f(x) dx = 1$
- 確率変数 $X$ の累積分布関数が $F(x)$ の時，『$X$ は分布 $F$ に従う』という
    - これは，どんな確率変数であっても，累積分布関数 $F(x)$ を持つことから来ている

### 確率変数の性質を表す量
:::tip[確率変数の性質を表す量]
- 確率変数 $X$ の **期待値 (平均 / 母平均)** : $\displaystyle \mu =  E[X] = 
\begin{cases} \sum_{x} x p(x)\\ \int_{-\infty}^{\infty} x f(x) dx \end{cases}$
- 確率変数 $X$ の **分散 (母分散)** : $\displaystyle \text{Var}(X) = E[(X - E[X])^2] = 
\begin{cases} \sum_{x} (x - E[X])^2 p(x)\\ \int_{-\infty}^{\infty} (x - E[X])^2 f(x) dx \end{cases}$
- 確率変数 $X$ の **モーメント(積率)** : $\displaystyle \mu'_k = E[X^k] = 
\begin{cases} \sum_{x} x^k p(x)\\ \int_{-\infty}^{\infty} x^k f(x) dx \end{cases}$ ($k$ は整数)
:::
- 基本的に期待値は，$E[|g(X)|] < \infin$ の時について考える

:::note[パーセント点]
また，下側 $\alpha$ 点 $x(\alpha) = F^{-1}(\alpha)$ を定義する。この時，$F(x(\alpha)) = P(X \leq x(\alpha)) = \alpha$ となり，
点 $x(\alpha)$ より小さくなる確率が $\alpha$ となる。
- **中央値** : $x(0.5)$
- **四分位範囲** $Q = x(0.75) - x(0.25)$
:::
- 不連続な場合は，右連続と左連続をうまく考える

### 逆関数法
また，累積分布関数 $F(x)$ が連続単調増加関数であれば，逆関数 $F^{-1}(x)$ が存在する。
そこで，$U$ を一様分布 $U(0, 1)$ に従う確率変数とすると，$X = F^{-1}(U)$ は $F(x)$ に従う確率変数となる。
このようにすれば，一様分布に従う確率変数を用いて，任意の分布に従う確率変数を生成することができる。
- $P(X \leq x) = P(F^{-1}(U) \leq x) = P(U \leq F(x)) = F(x)$

---
## 母関数
確率分布を調べる際に，母関数を用いることがある。

### 確率母関数
:::tip[確率母関数]
$|s| \leq 1$ として，**確率母関数 $\displaystyle G(s) = E[s^X] = \sum_{x = 0}^\infin s^x p(x)$** と定義する。
確率母関数は主に，**非負の整数値を取る確率変数** に対して用いられる。$G(1) = 1$ であり，以下が成り立つ。
- $\displaystyle p(k) = \frac{1}{k!} G^{(k)}(0)$ ($s$ に関する微分)
- $\displaystyle E[X(X-1)\cdots(X-k+1)] = G^{(k)}(1)$。特に，$E[X] = G'(1)$
:::

### 積率母関数
:::tip[積率母関数]
$\theta \in \mathbb{R}$ として，**積率母関数 $\displaystyle \phi(\theta) = E[e^{\theta X}]$** と定義する。
積率母関数は，一般の (特に連続の) 確率変数に対して用いられるが，**存在しない場合** もある。
- $\displaystyle \mu'_k = E[X^k] = \phi^{(k)}(0)$
:::
- $E[e^{\theta X}]$ を計算する際，その積分が収束するかが問題となる。特に，平均や分散が存在しない分布には用いれない
- 特に，原点周りで $\phi(\theta) = 1 + \mu'_1 \theta + \frac{\mu'_2}{2!} \theta^2 + \cdots$

### 特性関数
:::tip[特性関数]
$t \in \mathbb{R}$ として，**特性関数 $\displaystyle \phi(t) = E[e^{itX}] = E[\cos(tX) + i \sin(tX)]$** と定義する。
特性関数は，**全ての分布に対して定義できる。**
- $\displaystyle \mu'_k = E[X^k] = i^{-k} \phi^{(k)}(0)$

また，逆転の公式として，$\int_{-\infty}^{\infty} |\phi(t)| dt < \infin$ の時，
$\displaystyle f(x) = \frac{1}{2\pi} \int_{-\infty}^{\infty} e^{-itx} \phi(t) dt$ が成り立つ。
:::
- 特性関数はフーリエ変換と対応する。$\phi(t) = E[e^{itX}] = \int_{-\infty}^{\infty} e^{itx} f(x) dx$ であり，
フーリエ変換では $F(t) = \int_{-\infty}^{\infty} e^{-itx} f(x) dx$ と複素共役の関係にある
    - 確率母関数は $z$ 変換，積率母関数はラプラス変換と近いらしい