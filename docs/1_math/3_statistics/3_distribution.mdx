---
title: 3. 代表的な確率分布
---

## 一次元・離散分布
なお，諸々の計算で，二項定理 : $\displaystyle (a + b)^n = \sum_{k=0}^n \binom{n}{k} a^{n - k} b^k$ やテイラー展開 (特に項別微分) が重要になってくる。
### 二項分布
:::tip[二項分布]
二項分布 $Bin(n,p)$ は，$n$ 回の独立な試行において，成功確率 $p$ の事象が $k$ 回起こる確率を表す分布である。
- 確率関数 : $p(k) = \binom{n}{k} p^k (1 - p)^{n - k}$ ($k = 0, 1, \cdots, n$)
- 期待値 : $E[X] = np$
- 分散 : $\text{Var}(X) = np(1 - p)$
- 確率母関数 : $G(s) = (1 + p(s - 1))^n$
:::
- $0$ か $1$ の値を取る確率変数をベルヌーイ変数と呼び，$X_i$ とすると，二項分布の確率変数 $X = \sum_{i=1}^n X_i$ である
- 二項分布は単一の分布ではなく，$n,p$ で決まる分布の集合である。これを **分布族** と呼ぶ。また，$n,p$ を **パラメータ**、**母数** と呼ぶ

### ポアソン分布
:::tip[ポアソン分布]
ポアソン分布 $Po(\lambda)$ は，平均成功回数 $\lambda = np$ のポアソン過程に従う確率変数 $X$ の分布である。
- 二項分布の $n \to \infin$，$p \to 0$ の極限で得られる分布である。直感的には，**一定時間内にランダムなイベントが何回発生するか**
- 確率関数 : $p(k) = \frac{\lambda^k e^{-\lambda}}{k!}$ ($k = 0, 1, \cdots$)
- 期待値 : $E[X] = \lambda$
- 分散 : $\text{Var}(X) = \lambda$
- 確率母関数 : $G(s) = e^{\lambda(s - 1)}$
:::
- 例えば，都市の人口 $n$ 人について，各々が 1 日で事故に遭う確率 $p$ の時，1 日で事故に遭う人数 $X \sim Po(np)$

### 負の二項分布
:::tip[負の二項分布]
負の二項分布 $NB(r,p)$ は，$r$ 回成功するまでの失敗回数を表す分布である。
- 確率関数 : $p(k) = \binom{k + r - 1}{k} p^r (1 - p)^k$ ($k = 0, 1, \cdots$)
- 期待値 : $E[X] = \frac{r(1 - p)}{p}$
- 分散 : $\text{Var}(X) = \frac{r(1 - p)}{p^2}$
- 確率母関数 : $G(s) = \left( \frac{p}{1 - (1 - p)s} \right)^r$
:::
特に，$r = 1$ の時は **幾何分布** と呼ばれ，$p(k) = p(1 - p)^k$ ($k = 0, 1, \cdots$) となる。$X$ は $p$ の成功が初めて起こるまでの失敗回数を表す。
- 幾何分布では，$k$ を試行回数とすることもある。すなわち，$p(k) = p(1 - p)^{k - 1}$ ($k = 1, 2, \cdots$)

### 超幾何分布
:::tip[超幾何分布]
超幾何分布は，特定のものが $M$ 個入っている $N$ 個のものから，$n$ 個を無作為に取り出した時，特定のものが $k$ 個入っている確率を表す分布である。
- 特定のものを $M$ 個の中から $k$ 個，残りを $N - M$ 個の中から $n - k$ 個選ぶ
- 確率関数 : $p(k) = \frac{\binom{M}{k} \binom{N - M}{n - k}}{\binom{N}{n}}$ ($k = \min(0, n - N + M), \cdots, \min(M, n)$)
- 期待値 : $E[X] = \frac{nM}{N}$
- 分散 : $\text{Var}(X) = \frac{nM(N - M)(N - n)}{N^2(N - 1)} = \frac{N - n}{N - 1} \frac{M}{N} \frac{N - M}{N} n$
:::

---
## 一次元・連続分布
### 一様分布
:::tip[一様分布]
一様分布 $U(a, b)$ は，区間 $[a, b]$ の中で一様な分布である。
- 確率密度関数 : $f(x) = \frac{1}{b - a}$ ($a \leq x \leq b$)
- 累積分布関数 : $F(x) = \frac{x - a}{b - a}$ ($a \leq x \leq b$)
- 期待値 : $E[X] = \frac{a + b}{2}$
- 分散 : $\text{Var}(X) = \frac{(b - a)^2}{12}$
:::

### 正規分布
:::tip[正規分布]
正規分布 $N(\mu, \sigma^2)$ は，平均 $\mu$，分散 $\sigma^2$ の分布である。
- 確率密度関数 : $f(x) = \frac{1}{\sqrt{2\pi \sigma^2}} e^{-\frac{(x - \mu)^2}{2\sigma^2}}$
- 累積分布関数 : $F(x) = \frac{1}{2} \left( 1 + \text{erf}\left( \frac{x - \mu}{\sqrt{2\sigma^2}} \right) \right)$
- 期待値 : $E[X] = \mu$
- 分散 : $\text{Var}(X) = \sigma^2$
- 積率母関数 : $\phi(\theta) = e^{\mu \theta + \frac{\sigma^2}{2} \theta^2}$
:::

特に，$N(0, 1)$ の正規分布を **標準正規分布** と呼び，$Z$ を確率変数とすることが多い。  
また，$Z$ の確率密度関数 : $\phi(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}$，
$Z$ の累積分布関数 : $\Phi(x) = \int_{-\infty}^x \phi(t) dt$ と書くこともある。

:::tip[標準化]
$Y \sim N(\mu, \sigma^2)$ の時，$Z = \frac{Y - \mu}{\sigma} \sim N(0, 1)$ となる。これを **標準化** と呼ぶ。
:::

### ガンマ分布
ガンマ関数は $\Gamma(x) = \int_0^\infty t^{x - 1} e^{-t} dt$ と定義される。特に，$\Gamma(n+1) = n \Gamma(n)$ である。
:::note[ガンマ分布]
ガンマ分布は，形状母数 $\nu > 0$ と尺度母数 $\alpha > 0$ の分布である。
- 確率密度関数 : $f(x) = \frac{1}{\Gamma(\nu) \alpha^\nu} x^{\nu - 1} e^{-\frac{x}{\alpha}}$ ($x > 0$)
- 期待値 : $E[X] = \nu \alpha$
- 分散 : $\text{Var}(X) = \nu \alpha^2$
- 積率母関数 : $\phi(\theta) = (1 - \alpha \theta)^{-\nu}$ ($\theta < \frac{1}{\alpha}$)
:::
特に，$\nu = 1$ の時は **指数分布** と呼ばれ，確率密度関数 : $f(x) = \frac{1}{\alpha} e^{-\frac{x}{\alpha}}$ ($x > 0$)，
累積分布関数 : $F(x) = 1 - e^{-\frac{x}{\alpha}}$ ($x > 0$) となる。

また，$\nu = \frac{n}{2},~\alpha = 2$ の時は **カイ二乗分布** と呼ばれ，
確率密度関数 : $f(x) = \frac{1}{2^{n/2} \Gamma(n/2)} x^{\frac{n}{2} - 1} e^{-\frac{x}{2}}$ ($x > 0$) となる。

### ベータ分布
ベータ関数は $B(x, y) = \int_0^1 t^{x - 1} (1 - t)^{y - 1} dt$ と定義される。特に，$B(n, m) = \frac{\Gamma(n) \Gamma(m)}{\Gamma(n + m)}$ である。
:::note[ベータ分布]
ベータ分布は，形状母数 $\alpha > 0$ と $\beta > 0$ の分布である。
- 確率密度関数 : $f(x) = \frac{1}{B(\alpha, \beta)} x^{\alpha - 1} (1 - x)^{\beta - 1}$ ($0 < x < 1$)
- 期待値 : $E[X] = \frac{\alpha}{\alpha + \beta}$
- 分散 : $\text{Var}(X) = \frac{\alpha \beta}{(\alpha + \beta)^2 (\alpha + \beta + 1)}$
:::

### その他
もちろん，これらの分布を混合することもできる。例えば，異なる累積分布関数 $F_1(x)$ と $F_2(x)$ を持つ確率変数 $X_1$ と $X_2$ があるとする時，
$X = p X_1 + (1 - p) X_2$ ($0 < p < 1$) の分布関数は，$F(x) = p F_1(x) + (1 - p) F_2(x)$ となる。
- 上記は，確率 $p$ で $X_1$，確率 $1 - p$ で $X_2$ を選ぶことを意味する
- 一般には，$F(x) = \int_{-\infty}^{\infty} F(x, \theta) g(\theta) d\theta$ のように，累積分布関数の集合 $F(x, \theta)$ と確率密度関数 $g(\theta)$ を用いて表すことができる

---
## 多次元・離散分布
### 多項分布
:::tip[多項分布]
多項分布は，$k$ 個の事象がそれぞれ $p_1, p_2, \cdots, p_k$ の確率で起こる試行を $n$ 回行った時，$k$ 個の事象がそれぞれ $x_1, x_2, \cdots, x_k$ 回起こる確率を表す分布である。
- 確率関数 : $p(x_1, x_2, \cdots, x_k) = \frac{n!}{x_1! x_2! \cdots x_k!} p_1^{x_1} p_2^{x_2} \cdots p_k^{x_k}$
- 期待値 : $E[X_i] = n p_i$
- 分散 : $\text{Var}(X_i) = n p_i (1 - p_i)$
- 共分散 : $\text{Cov}(X_i, X_j) = - n p_i p_j$ ($i \neq j$)
- 多項分布の周辺分布も多項分布に従い，特に，$Y_i \sim \text{Bin}(n, p_i)$ となる
- 多項分布の条件付き分布も多項分布に従う
:::

---
## 多次元・連続分布
### 多変量正規分布
:::tip[多変量正規分布]
$X_i \sim N(\mu_i, \sigma_i^2)$ ($i = 1, 2, \cdots, n$) であり互いに独立な時，$X = (X_1, X_2, \cdots, X_n)^T$ は多変量正規分布に従う。
- 確率密度関数 : $f(x) = \frac{1}{(2\pi)^{n/2} |\Sigma|^{1/2}} e^{-\frac{1}{2} (x - \mu)^T \Sigma^{-1} (x - \mu)}$
- 期待値 : $\mu = (\mu_1, \mu_2, \cdots, \mu_n)^T$
- 分散共分散行列 : $\Sigma = \begin{pmatrix}
        \sigma_1^2 & \sigma_{12} & \cdots & \sigma_{1n} \\
        \sigma_{21} & \sigma_2^2 & \cdots & \sigma_{2n} \\
        \vdots & \vdots & \ddots & \vdots \\
        \sigma_{n1} & \sigma_{n2} & \cdots & \sigma_n^2
    \end{pmatrix}$
- 積率母関数 : $\phi(\theta) = \exp\left( \theta^T \mu + \frac{1}{2} \theta^T \Sigma \theta \right)$

特に，$X_i \sim N(0, 1)$ であり互いに独立な時，$X = (X_1, X_2, \cdots, X_n)^T$ を **標準多変量正規分布** と呼ぶ。
- 確率密度関数 : $f(x) = \frac{1}{(2\pi)^{n/2}} e^{-\frac{1}{2} x^T x}$
:::
$Z = a + BX$ のようにアフィン変換を行うと，$Z \sim N(a + B\mu, B \Sigma B^T)$ となる。
- これは，積率母関数 $\phi_Z(\theta) = E[\exp (\theta^T (a + BX))] = \exp\left( \theta^T (a + B\mu) + \frac{1}{2} \theta^T B \Sigma B^T \theta \right)$ からわかる

また，$X_i$ と $X_j$ が無相関である時，$X_i$ と $X_j$ は独立である。すなわち，多変量正規分布においては，**無相関と独立は同値** となる。
- 二次元の場合，積率母関数 : $\phi(\theta) = \exp\left( \theta_1 \mu_1 + \frac{1}{2} \theta_1^2 \sigma_1^2 + \theta_2 \mu_2 + \frac{1}{2} \theta_2^2 \sigma_2^2 + \theta_1 \theta_2 \sigma_{12} \right)$ からわかる

---
## まとめ
### 離散分布
<div style={{ display: 'flex', justifyContent: 'left', gap: '20px', flexWrap: 'wrap' }}>
    <div style={{ width: '30%'}}>
        <div style={{ marginLeft: '20px' }}>二項分布</div>
        <img src="/img/math/binomial-distribution.png" style={{ width: '100%' }} alt="binomial-distribution" />
    </div>
    <div style={{ width: '30%' }}>
        <div style={{ marginLeft: '20px' }}>ポアソン分布</div>
        <img src="/img/math/poisson-distribution.png" style={{ width: '100%' }} alt="poisson-distribution" />
    </div>
    <div style={{ width: '30%' }}>
        <div style={{ marginLeft: '20px' }}>負の二項分布</div>
        <img src="/img/math/negative-binomial-distribution.png" style={{ width: '100%' }} alt="negative-binomial-distribution" />
    </div>
</div>

<div style={{ display: 'flex', justifyContent: 'left', gap: '20px', flexWrap: 'wrap' }}>
    <div style={{ width: '30%'}}>
        <div style={{ marginLeft: '20px' }}>幾何分布</div>
        <img src="/img/math/geometric-distribution.png" style={{ width: '100%' }} alt="geometric-distribution" />
    </div>
    <div style={{ width: '30%' }}>
        <div style={{ marginLeft: '20px' }}>超幾何分布</div>
        <img src="/img/math/hypergeometric-distribution.png" style={{ width: '100%' }} alt="hypergeometric-distribution" />
    </div>
</div>

### 連続分布

<div style={{ display: 'flex', justifyContent: 'left', gap: '20px', flexWrap: 'wrap' }}>
    <div style={{ width: '30%' }}>
        <div style={{ marginLeft: '20px' }}>ガンマ分布</div>
        <img src="/img/math/gamma-distribution.png" style={{ width: '100%' }} alt="gamma-distribution" />
    </div>
    <div style={{ width: '30%' }}>
        <div style={{ marginLeft: '20px' }}>指数分布</div>
        <img src="/img/math/exponential-distribution.png" style={{ width: '100%' }} alt="exponential-distribution" />
    </div>
    <div style={{ width: '30%' }}>
        <div style={{ marginLeft: '20px' }}>カイ二乗分布</div>
        <img src="/img/math/chi-squared-distribution.png" style={{ width: '100%' }} alt="chi-squared-distribution" />
    </div>
</div>

<div style={{ display: 'flex', justifyContent: 'left', gap: '20px', flexWrap: 'wrap' }}>
    <div style={{ width: '30%' }}>
        <div style={{ marginLeft: '20px' }}>ベータ分布</div>
        <img src="/img/math/beta-distribution.png" style={{ width: '100%' }} alt="beta-distribution" />
    </div>
    <div style={{ width: '30%' }}>
        <div style={{ marginLeft: '20px' }}>正規分布</div>
        <img src="/img/math/normal-distribution.png" style={{ width: '100%' }} alt="normal-distribution" />
    </div>
</div>
### 全体像
<img src="/img/math/distribution.png" style={{ width: '60%' }} alt="distribution" />
図は[こちら](https://academ-aid.com/statistics/summary-dists/) や [統計WEB](https://bellcurve.jp/statistics/course/)，Wikipedia などから引用