---
title: 10. 量子コンピュータの種類
---

## FTQC（誤り耐性量子コンピュータ）
:::tip[FTQC]
量子計算中に発生するエラーを検出・訂正する機能を備えた量子コンピュータ。しかし，誤り訂正には非常に多くの量子ビットが必要で現在は実現されていない。
:::
そこで，別の量子コンピュータが提案されている。

---
## 量子アニーリング
量子アニーリングはあくまで量子計算手法の一つなので，汎用的な量子計算機とは異なる。
:::tip[量子アニーリング]
量子効果（重ね合わせの原理など）を利用した最適化手法。 量子ゲート方式に比べればノイズの影響を受けにくく 5000 qubitsを超えるモデルが存在する。
:::
### 古典アニーリング
最適解の探索のために組合せを変化させていく過程で，必ずしもコスト関数が小さくならなくてもある確率で次の状態として選択する。
- 温度：どれだけエネルギーの減少を重要視するか（高いほど目まぐるしく変化させる。低いとエネルギーが低くなる方向にしか変化しない）局所解での凍結を回避

#### イジング模型（Ising模型）
：古典アニーリングの例で，量子アニーリングの原理を理解するための出発点。
- $\pm 1$ の二つの数字を取るイジング変数： $\sigma_i$
- $i= 1, 2, …$ はイジング変数の番号. サイト（格子点）番号とも
- 相互作用エネルギー： $-J_{ij}\sigma_i\sigma_j$
- 局所磁場エネルギー： $-h_i\sigma_i$
- ハミルトニアン（全エネルギー）： $H(\sigma) = - \sum_{i<j}J_{ij}\sigma_i\sigma_j - \sum_{i=1}^N h_i\sigma_i$：最小化したい

:::warning[重要]
任意の組み合わせ最適化問題は，多体相互作用(多数のイジングスピンの積で表されるエネルギー)を持つイジング模型の基底状態探索問題として表すことが可能
:::
---
## NISQ
:::tip[NISQ]
量子ゲート操作1回につき 0.1 ~ 1% という高い確率で発生するエラーを訂正する機能が十分でない量子コンピュータだが，
何らかの古典コンピュータを凌駕するような使い道を見出すことが期待されている。
:::
- 例：
    - IBM Quantum：超電導量子ビット
    - Google Sycamore：Googleが開発した53量子ビット．超電導量子ビット
    - Rigetti Aspen：超電導量子ビット
    - Honeywell Quantum Computer：超電導量子ビット
    - IonQ Quantum Computer：イオントラップ方式

以下は，NISQ でも利用されるものをいくつか紹介する。

### VQE（Variational Quantum Eigensolver）
:::tip[VQE]
量子多体系の基底状態を求める変分アルゴリズム。変分量子固有値法ともいう。

- ハミルトニアンの期待値を最小化するように，パラメータ付き量子回路で作り出される試行状態（ansatz）を最適化する
- 量子コンピュータ + 古典コンピュータのハイブリッド
:::
<img src="/img/information/quantum/vqe.png" alt="VQE" style= {{ width: "50%" }} />
画像は [量子コンピュータ勉強会レポート（その３）](https://www.hpc.co.jp/tech-blog/2021/01/14/quantum-computer_report_3/) より引用

- 量子化学計算などで利用される
- 量子回路が比較的単純で，NISQ デバイスでも実行可能
- 量子位相推定で最小固有値を求められるが，実用的にはまだ難しい 
$\rightarrow$ $\lambda_{min} \leq \bra{\psi(\theta)}H\ket{\psi(\theta)}$ で求める
 
#### VQE の流れ
1. ハミルトニアンを用意する
2. 量子回路 $U(\theta)$ に入力し試行状態 $U(\theta)\ket{0 \cdots 0} = \ket{\psi(\theta)}$ を作成
3. エネルギー期待値 $E(H(\theta)) = \bra{\psi(\theta)}H\ket{\psi(\theta)}$ を計算
    - $H$ は Pauli 演算子 $P_i \in \{I, X, Y, Z\}^{\otimes n}$ を用いて $H = \sum_i h_i P_i$ と書ける
    - $E(H(\theta)) = \sum_i h_i \bra{\psi(\theta)}P_i\ket{\psi(\theta)}$：パウリ演算子の期待値を測定結果から求め，古典コンピュータで計算
4. $ E(H(\theta))$ を最小化するように $\theta$ を更新

### QAOA（Quantum Approximate Optimization Algorithm）
:::tip[QAOA]
VQE を使って 0-1 整数計画問題を解くアルゴリズム。0-1整数計画問題はイジングハミルトニアンで与えられる。  
$H = \sum_i h_i Z_i + \sum_{i > j} J_{ij} Z_i Z_j$，$h_i$：磁場の強さ，$J_{ij}$：結合の強さ，$Z_i$：パウリ Z 演算子
:::

#### QAOA の流れ
ほんとうによくわからない。
1. 初期状態 $\ket{s} = \ket{+}^{\otimes n} = \frac{1}{\sqrt{2^n}}\sum_{z=0}^{2^n-1}\ket{z}$ を用意する
2. パラメータ $\{\beta_1,…\beta_l\},\{\gamma_1,…\gamma_l\}$ で指定されるユニタリゲート $U_c(\gamma_i),~U_X(\beta_i)$ 
を作用させて $n$ ビット量子状態 $\ket{\beta,\gamma}$ を得る
3. 量子コンピュータで期待値 $\bra{\beta,\gamma}C(Z)\ket{\beta,\gamma}$ を評価・測定する
    - $C(Z)$ はコスト関数
4. 最適解が得られるまでパラメータの更新を繰り返す
5. 何回か状態 $\ket{\beta^*,\gamma^*}$ を Z 基底で測定し，良さそうな結果を $z_1,…z_n$ として出力する

### QCL(量子回路学習)
:::tip[QCL]
パラメータ付き量子回路からの出力と訓練出力の差を最小化するようにパラメータを最適化する手法。
:::

#### QCL の流れ
これも本当によくわからない。
1. 訓練入力 $x_i$ をパラメータとする量子回路 $U_{in}(x_i)$ を量子ビットに作用させて $x_i$ の情報をエンコードした入力状態 $\{\ket{\psi_{in}(x_i)}\}$ を作る
2. 入力状態をパラメータ $\theta$ で決まる量子回路 $U(\theta)$ によって
出力状態 $\ket{\psi_{out}(x_i,\theta)} = U(\theta)\ket{\phi_{in}(x_i)}$ に変換する
3. 量子ビットを計算規定で測定し，ビット列 $z_i$ を取得. 関数で最終的なモデル出力 $\{y_i\}$ に変換
4. 訓練出力とモデル出力の間の差を求める損失関数 $L(\theta)$ を計算して最小化する $\theta$ を求める
    1. パラメータシフト法
5. 未知の人工データ $x$ から予測 $y(x,\theta^*)$を得る

