---
title: 4. 通信路符号化
---

:::warning[目標]
通信路符号化の方法とその限界を理解する。すなわち，与えられた通信路に対して，どのような入力を行えばより多くの情報を伝達できるかを考える !
:::

## 通信路容量
[通信路のモデル](/docs/information/information-theory/intro#通信路のモデル) も参照。
:::tip[通信路容量]
通信路の入力系列 $\bm{X}_n = X_0 X_1 \cdots X_{n-1}$ ，出力系列 $\bm{Y}_n = Y_0 Y_1 \cdots Y_{n-1}$ と置く。
この時，通信路容量を以下のように定義する。ただし，$\bm{P}(\bm{X}_n)$ は $\bm{X}_n$ の確率分布。
$$
C = \lim_{n\to \infty} \max_{\bm{P}(\bm{X}_n)} \frac{1}{n} I(\bm{X}_n; \bm{Y}_n)
$$

つまり，任意の通信路に対して通信路容量は，入力の確率分布を変化させた時の入力と出力の相互情報量の最大値を示す。
:::
なお **無記憶通信路** であれば，$\displaystyle C = \max_{\bm{P}(\bm{X})} I(X; Y)$ となる。  

また **無記憶通信路** であれば，入力アルファベット $A = \{a_1, a_2,\cdots,a_r \}$，出力アルファベット $B = \{b_1, b_2,\cdots,b_s \}$ に対して，
$p_{ij} = P_{Y|X}(b_j|a_i)$ として，通信路の特性を表す **通信路行列** 
$T = \begin{pmatrix} p_{11} & \cdots & p_{1s}\\ \vdots & \ddots & \vdots \\p_{r1} & \cdots & p_{rs}\end{pmatrix}$ を定義できる。(各行の和が $1$)

- アナログ信号では，帯域幅 $B$ [Hz]，信号の総電力 $S$，ガウスノイズの総電力 $N$ として，単位時間あたりの通信容量 : $C = B\log_2(1 + \frac{S}{N})$ と表される

### 無記憶一様通信路
入力について一様な通信路を考える。
入力からみて，出力の確率分布が記号を入れ替えれば同じ形になる通信路であった。
(すなわち，集合 $\{p_{i1},…,p_{is}\}$ が $i$ によらない)

入力の確率分布を $\bm{p} = (p_1, p_2, \cdots, p_r)$ とすると，  
$H(Y|X) = - \sum_x P(x) \sum_y P(y|x) \log_2 P(y|x) = - \sum_{i=1}^r p_i \sum_{j=1}^s p_{ij} \log_2 p_{ij}$ となる。

ここで，入力について一様なので $H(Y|X) = - \sum_{j=1}^s p_{1j} \log_2 p_{1j}$ となる。( $1$ の部分は何でも良い)

よって，通信路容量 $\displaystyle C = \max_{\bm{p}} H(Y) + \sum_{j=1}^s p_{1j} \log_2 p_{1j}$ となる。

- 例 : 2 元対称通信路 : $T = \begin{pmatrix} 1-p & p\\ p & 1-p\end{pmatrix}$ では，
$C = \max_{p} H(Y) + (1-p) \log_2 (1-p) + p \log_2 p$ となる。$H(Y)$ は入力 $p_1 = p_2 = 0.5$ の時 $1$ を取るので，
$C = 1 + (1-p) \log_2 (1-p) + p \log_2 p = 1 - \mathcal{H}(p)$ となる
    - すなわち，$p = 0,1$ の時は $C = 1$，$p = 0.5$ の時は $C = 0$
- 例 : 2 元対称消失通信路：$T = \begin{pmatrix} 1-p_{\times}-p & p_{\times} & p\\ p & p_{\times} & 1-p_{\times}-p\end{pmatrix}$ では，
$C = \max_{p} H(Y) + (1-p_{\times}-p) \log_2 (1-p_{\times}-p) + p_{\times} \log_2 p_{\times} + p \log_2 p$ となる。
$H(Y)$ は入力 $p_1 = p_2 = 0.5$ の時最大となり，結果として $C = (1 - p_{\times})\left(1 - \mathcal{H}(\frac{p}{1-p_{\times}})\right)$ となる


### 加法的 2 元通信路
$Y = X \oplus E$ というモデルを考える。ただし，$E$ と $X$ は独立とする。  
この時，$I(X; Y) = H(Y) - H(E \oplus X | X) = H(Y) - H(E)$ となる。

ここで，$X$ の確率分布について，$P_X(0) = P_X(1) = 0.5$ とすると，$P_Y(0) = P_Y(1) = 0.5$ となるため，$C = 1 - H(E)$ となる。

なお，これは誤り源に記憶がある場合 (マルコフモデルで表される場合など) でも成り立つ。

---
## 通信路符号化
:::warning[目標]
通信路の雑音や誤りの影響を抑えるために，冗長性を付加して信頼性を向上させる !
:::

:::tip[通信路符号]
通信路の入力アルファベットと出力アルファベットを共に $A = \{a_1, a_2,\cdots,a_r \}$ とする。  
この時，入力系列として $A^n$ から選ばれた $M$ 個の系列の集合 $C$ を **通信路符号** と呼び，それぞれの系列を **符号語** $\bm{w}_i \in C$ と呼ぶ。

また，$A^n$ は **受信空間** とも呼ばれ，受信空間には，入力が $\bm{w}_i$ と推測できる復号領域 $\Omega_i$ と
符号語が推定不可能な領域が広がっている。

<img src="https://siglead.wpx.jp/wp-content/uploads/2022/08/img_chap01_02_sp.png" alt="受信空間のイメージ" style={{ width: '30%' }} />
図は [誤り訂正符号](https://siglead.com/technology/errorcorrectioncode/) より引用
:::
この時，符号語を $M$ 個とした時 $R = \frac{1}{n} \log_2 M$ ビット/記号 を **情報速度** と呼び，この速度で情報を伝達できる。
また，冗長性を加えない場合，$R_{max} = \frac{1}{n}\log_2 r^n$ ビット/記号 とおける ( $r$ 元通信路)。
そこで，$\nu = \frac{R}{R_{max}}$ を **符号化率**，$\rho = 1 - \nu$ を **冗長率** と呼ぶ。(正規化せずに，$R$ を符号化率と呼ぶこともある)

- 通信路符号 $C$ としては等長符号を考えることが多いため，$C \subset A^n$ としている
- 情報速度のイメージは，ありうる符号語のうち何割利用しているか
- **情報速度の最大値 = 通信路容量** である

### 最大事後確率復号 (MAP)
:::warning[目標]
各符号語に対して最適な復号領域の設定方法を考える。つまり，入力 $\bm{w}_i$ を送信し $\bm{y}$ を受信した時，$\bm{w}_i$ と推測できる確率が最大となるようにする。
:::
:::tip[MAP]
入力の確率分布 $P(\bm{w}_i)$ がわかっている場合，$\bm{y}$ を受信した時 $P(\bm{w}_i|\bm{y})$ が最大となる $\bm{w}_i$ と推測し，$\bm{y} \in \Omega_i$ とする。
$$
\hat{\bm{w}} = \arg\max_{\bm{w}_i}P(\bm{w}_i|\bm{y}) = \arg\max_{\bm{w}_i} P(\bm{y}|\bm{w}_i) P(\bm{w}_i)
$$
:::
- 全体の復号誤り確率を最小化するという点で最も最適な復号方式
- ただ，入力の確率分布 $P(\bm{w}_i)$ を知っている or モデル化する必要がある

### 最尤復号法 (Maximum Likelihood Decoding, MLD)
:::tip[最尤復号法]
入力の確率分布が未知の場合，各符号語の入力確率が等しいと仮定すれば，正しく復号される確率 $P_c = \frac{1}{M} \sum_{i=1}^M P(\bm{y} | \bm{w}_i)$ となるので，
各 $\bm{y}$ について，$P(\bm{y}|\bm{w}_i)$ が最大となる $\bm{w}_i$ と推測し，$\bm{y} \in \Omega_i$ とする。

$$
\hat{\bm{w}} = \arg\max_{\bm{w}_i} P(\bm{y}|\bm{w}_i)
$$
:::
- この方法は，入力の確率分布が未知の場合 (特に等確率に近い場合) において有用であるが，
実際に全ての符号語 $\bm{w}_i$ に対して $P(\bm{y}|\bm{w}_i)$ を計算するのは困難である

### 通信路符号化定理
:::tip[通信路符号化定理]
通信路容量 $C$ の通信路に対し，情報速度 $R$ について $R < C$ $\Leftrightarrow$ 
$\forall \epsilon$ に対し，復号誤り率 $P_e < \epsilon$ を満たす情報速度 $R$ の符号が存在する。
:::
証明のイメージ
- $I(\bm{X}_n; \bm{Y}_n) = nC$ となるような無記憶情報源 $S_0$ の長さ $n$ の系列を考え，
代表的系列 $2^{nH(X)}$ のうち $M = 2^{nR}~(R < C)$ 個の系列をランダムに選ぶ。
この時，議論をぶっ飛ばすと受信される代表的系列は平均して $2^{nH(X | Y)}$ 個となる
- よって，復号誤り率 $P_e = 1 - \left(1 - \frac{2^{nR}}{2^{nH(X)}}\right)^{2^{nH(X | Y)}} \approx 2^{-n(C - R)}$ となる

---
## 通信路符号化法
:::warning[目標]
通信路符号化の具体的な方法を学ぶ。すなわち，どのように冗長性を付加して信頼性を向上させるかを考える !
:::
