---
title: 2. 音声の音響分析
---

:::warning[目標]
音声がどのように言語的情報を伝えているのかを工学的に記述する！
:::

## 音声生成のメカニズムと特徴量
音声生成は，以下のような流れで行われる。
1. 発声：声門付近で生じる音源生成
    - 音源は，インパルス列というよりは周期的な三角波に近い
    - 母音だと声帯振動を伴い周期的波形（有声音），子音だと声門以外の発声器官も関与
    - 声帯振動を伴わない音：無声音
    - 「高さ」「強さ」「長さ」といった特徴量が生じる
2. 調音：声道の形状によって音響的な特徴が変化
    - これ自体は **共振・共鳴現象**
    - 「音色」といった特徴量が生じる
3. 口からの放射

### 音声の高さ
:::tip[音声の高さ]
音声の高さ = 基本周波数（物理的特性） = ピッチ（心理的特性）。  
音声はおよそ周期的な波形となり，その基本周期 $T_0$ ，基本周波数 $F_0$ として，  
音声：$s(t) = \sum_{n=0}^{\infty} A_n \cos(2\pi(nF_0)t + \theta_n)$ とおける。
:::
- 周期波形の場合は周波数が飛び飛びの値を取る
- 倍音：基本周波数の整数倍の周波数成分
- ハーモニクス：基本周波数と倍音にエネルギーが集中すること

### 音声の強さ
:::tip[音声の強さ]
音声の強さ（大きさ） = インテンシティレベル/音圧レベル（物理的特性） = ラウドネス（心理的特性）。  
- インテンシティレベル：最小可聴パワー値（$10^{-16}~W/cm^2$）を基準とするデシベル
- 音圧レベル：最小可聴音圧値（$20~\mu Pa$）を基準とするデシベル
:::
- ラウドネスを音圧レベルとの関係を調査する事で尺度化するが，実はラウドネスは基本周波数とも関係がある $\rightarrow$ 等ラウドネス曲線
- 時間区間内の波形振幅の2乗平均の平方根 RMS：$\sqrt{\frac{1}{T}\sum_{t=0}^{T-1}s_t^2}$ を用いることも多い

### 音声の長さ
:::tip[音声の長さ]
音声の長さ = 音声波形の継続時間（物理的特性）
:::

### 音声の音色
:::tip[音声の音色]
音声の音色 = スペクトル包絡（物理的特性）
:::
- **スペクトル包絡 = 周波数軸上でのエネルギー分布の違い**
- 音色は声道形状や長さによって変化する：舌の位置や唇の構えを変えたり
    - 母音図：舌の位置と唇の構えによる母音の音色の変化を示す図（母音の音源は同じ）

### 母音の音響的特徴
音源波形（ = 三角波）が音響変形をうけて共振・共鳴運動を行う

#### 第 $n$ フォルマント（共振周波数）$F_n$
：音声の周波数成分のうち強度が大きい周波数成分で，スペクトル包絡のピークに対応する。これが母音の音色を決定する。
- フォルマント周波数と倍音は区別しづらい場合がある
- $F_1$ と $F_2$ の周波数の大きさのプロットによって母音が分類することもできる（人によっても分布は異なる）
- 単純な管を考えると，$F_n=\frac{c}{4l}(2n-1)~~$  ($c$：音速（約 $340~m/s$），$l$：声道の長さ)

### 子音の音響的特徴
声帯振動だけでなく，声道の開閉による流れの変化によって，音源の位置が様々に変化して生成される。
- IPA（国際音声学会）によって世界中全ての子音が分類されている：音声記号によって表現する

#### 音素：言語話者が区別する発声の最小単位。複数の音声記号がまとまってできている場合もある。

---
## 音声の音響的分析
:::warning[目標]
どうやって特徴量を取り出して分析するかを考える！
:::

まずは，音声をマイクロフォンによって取得し，空気の疎密波 $\rightarrow$ 電気的振動 $\rightarrow$ デジタル信号に変換する。
ここでは，この過程については説明せず，デジタル信号から特徴量を取り出す方法について考える。
いくつかの方法をひたすら列挙する形式としている。

### 短時間フーリエ変換（STFT）
人間は音声の位相よりも周波数成分の変化に敏感であるため，音声波形を周波数成分に変換して分析する。
ただし，音声は時間的に変化するため，スペクトル特性（周波数特性）が変化しないと仮定できる長さで窓関数をかけてフーリエ変換する。  
そのうち STFT は**連続信号**を周波数解析したい場合に適用する。

:::tip[短時間フーリエ変換（STFT）]
区間長 $T$ の窓関数 $w(t)$ を用いて，時刻 $u$ における音声波形 $s(t)$ の周波数成分 $S(\omega, u)$ を次のように表す。
$\\ S(\omega, u) = \int_{-\infty}^{\infty} w(t-u)s(t)e^{-j\omega t}dt = \int_{u-\frac{T}{2}}^{u+\frac{T}{2}} w(t-u)s(t)e^{-j\omega t}dt $
:::

### 離散フーリエ変換（DFT）
離散信号を周波数解析したい場合に適用する。
:::tip[離散フーリエ変換（DFT）]
系列長 $N$ の離散信号（標本値列） $s_k = s(kT_0)$ の周波数成分 $S_n$ を次のように表す。

離散フーリエ変換（DFT）：$S_n = \sum_{k=0}^{N-1} s_k e^{-j\frac{2\pi}{N}kn}\\$
離散逆フーリエ変換（IDFT）：$s_k = \frac{1}{N}\sum_{n=0}^{N-1} S_n e^{j\frac{2\pi}{N}kn}$

この時，窓長：$NT_0$，周波数分解能：$\frac{1}{T_0}$ となる
:::
DFT は周期 $NT_0$ の周期信号を周波数解析するためのものなので，完全な周期信号でない場合は波形の端でスペクトルが歪む。
そこで，ハミング窓などの窓関数をかけて両端の影響を減らすことが多い。

### ソースフィルタモデル
:::tip[ソースフィルタモデル]
マイクロフォンで得られる音声波形 $s(t)$ を，音源信号 $g(t)$ と声道フィルタ $v(t)$，放射フィルタ $r(t)$ の積として表す方法。

$s(t) = r(t) \ast (v(t) \ast g(t))，~S(\omega) = R(\omega)\left(V(\omega)G(\omega)\right)$
:::
- $g(t)$ をインパルス列（有声音源）や白色ノイズ（無声音源）などスペクトル包絡特性が平坦な信号でモデル化する
- 静的特徴：$|G(\omega)|$ のスペクトル特性は約 $-12~dB/\mathrm{oct}$ の傾き，$R(\omega)$ のスペクトル特性は約 $6~dB/\mathrm{oct}$ の傾きを持つ
- そこで，$s(t)$ を高域強調（$+6~dB/\mathrm{oct}$）した信号 $s'(t)$ を用いると，
$S'(\omega) = V(\omega)G_0(\omega)$ 。：これを分析する。以後は，$S'(\omega)$ を $S(\omega)$ と置き換えて考える。

### ケプストラム係数
:::tip[ケプストラム係数]
**FFTケプストラム係数：$\log|S(\omega)|$ を逆フーリエ変換したもの**。単位は s だが，よくケフレンシーと呼ばれる。
- $S(\omega)$：高域強調後の信号 $s'(t)$ を FFT したもの
:::
ソースフィルタモデル：$S(\omega) = V(\omega)G(\omega)$ （$G(\omega)$は声帯振動のスペクトル，$V(\omega)$は声道フィルタ）を考える。  
$\log|S(\omega)| = \log|V(\omega)| + \log|G(\omega)|$ であり，$\log|G(\omega)|$ は周波数に関わらず一定なので，
$S(\omega)$ の高域成分を 0 として FFT すると，$V(\omega)$ のスペクトル包絡が得られる。
- 低ケフレンシ成分：声道によるスペクトル包絡に対応
- 高ケフレンシ成分：声帯振動による音源に対応

### メル周波数ケプストラム係数（MFCC）
:::tip[メル周波数ケプストラム係数（MFCC）]
**メル周波数ケプストラム係数（MFCC）：対数パワースペクトル $\log |S(\omega)|$ をメル尺度に基づいたフィルタバンクでフィルタリングし，
得られた 「メル化対数パワースペクトル」 を逆コサイン変換したもの。**
:::
- メル尺度：人間の聴覚特性に基づいた周波数尺度（低域は分解能が高く，高域は分解能が低い）
- フィルタバンク：低域フィルタから高域フィルタまでのバンドパスフィルタを並べたもの。メル尺度に基づくと、低域フィルタの方が周波数幅が狭く密になる
- メル化対数パワースペクトル（ = メルスペクトラム）は離散スペクトル，メル周波数ケプストラム係数（MFCC）は離散信号
- 離散コサイン変換（DCT）：DFT のような離散信号を周波数成分に変換する手法
- 参考になる資料：[MFCC（メル周波数ケプストラム係数）入門](https://qiita.com/tmtakashi_dist/items/eecb705ea48260db0b62)，
[メル周波数ケプストラム係数（MFCC）](https://aidiary.hatenablog.com/entry/20120225/1330179868)

### 基本周波数 $F_0$ の抽出
:::tip[基本周波数 $F_0$ の抽出]
基本周波数 $F_0$ は自己相関関数を用いて抽出することが多い。  
標本値列 $s_k~(k=0,1,\cdots,N-1)$ として，**自己相関関数：$r_k = \sum_{t=0}^{N-1-k} s_t s_{t+k}$**，
正規化自己相関関数：$v_k = \frac{r_k}{r_0}$ とおくと，$F_0$ は $v_k$ のピーク位置の時間遅れ $k_0$ から
$F_0 = \frac{1}{k_0T_0}$ として抽出できる。
:::
- ただし，半ピッチ $\frac{1}{2}k_0$ や倍ピッチ $2k_0$ もピークとして現れることがある

### 連続音声の分析
:::tip[連続音声の分析]
これまで，定常と見なせる短時間の発声区間を対象にしていたが，基本的に発声は非定常。  
そこで，区間幅 $N$ のフレームをシフト長 $M$ でスライドさせて，連続音声を分析することが多い。  
この時，それぞれの少しずつ時間的にずれた区間で，特徴量がベクトル $\bm{o}_k$ として得られる。

さらに，**$\Delta$ 特徴量：特徴量ベクトル $\bm{o}_k$ の時間微分や差分，$\Delta \Delta$ 特徴量：$\Delta$ 特徴量の時間微分や差分** を利用することもある。
:::
- 例えば，$\Delta$ MFCC や $\Delta \Delta$ MFCC。
$d$ 次元の MFCC に $\Delta$ 特徴量と $\Delta \Delta$ 特徴量を加えた $3d$ 次元の特徴量ベクトルを $\bm{o}_k$ とすることもある。
- フレーム間や異なる音の音響的差異として以下のようなものを用いたりする
    - ピッチ感覚：$d_{F_0}(a, b) = \log F_0(a) - \log F_0(b)$
    - 音色距離：$d_{spec}(S,T) = \sum_{k} |c_k^S - c_k^T|^2$ （$c_k^S$：$S$ のケプストラム係数の $k$ 番目の成分）
- 同じ音色でも音の長さは異なる $\rightarrow$ DTW（動的時間伸縮法）などを用いて音声認識を行う